import { useState } from "react";
import { Label, TextInput, Select, Button } from "flowbite-react";
import { AiOutlineCloseCircle } from "react-icons/ai";

interface AddCompanyForm{
  onCloseModalAction: (state: boolean)=> void;
}

const allExtraFields = [
  "Адрес производства",
  "Адрес дополнительной площадки",
  "Основная отрасль",
  "Подотрасль (Основная)",
  "Основной ОКВЭД",
  "Вид деятельности по основному ОКВЭД",
  "Производственный ОКВЭД",
  "Дата регистрации",
  "Руководитель",
  "Головная организация",
  "ИНН головной организации",
  "Контактные данные руководства",
  "Контакт сотрудника организации",
  "Контактные данные ответственного по ЧС",
  "Сайт",
  "Электронная почта",
  "Данные об оказанных мерах поддержки",
  "Наличие особого статуса",
  "Статус МСП",
  "Выручка предприятия, тыс. руб. 2022",
  "Выручка предприятия, тыс. руб. 2023",
  "Выручка предприятия, тыс. руб. 2024",
  "Чистая прибыль (убыток), тыс. руб. 2022",
  "Чистая прибыль (убыток), тыс. руб. 2023",
  "Чистая прибыль (убыток), тыс. руб. 2024",
  "Среднесписочная численность персонала (всего по компании), чел 2022",
  "Среднесписочная численность персонала (всего по компании), чел 2023",
  "Среднесписочная численность персонала (всего по компании), чел 2024",
  "Среднесписочная численность персонала, работающего в Москве, чел 2022",
  "Среднесписочная численность персонала, работающего в Москве, чел 2023",
  "Среднесписочная численность персонала, работающего в Москве, чел 2024",
  "Фонд оплаты труда всех сотрудников организации, тыс. руб 2022",
  "Фонд оплаты труда всех сотрудников организации, тыс. руб 2023",
  "Фонд оплаты труда всех сотрудников организации, тыс. руб 2024",
  "Фонд оплаты труда сотрудников, работающих в Москве, тыс. руб. 2022",
  "Фонд оплаты труда сотрудников, работающих в Москве, тыс. руб. 2023",
  "Фонд оплаты труда сотрудников, работающих в Москве, тыс. руб. 2024",
  "Средняя з.п. всех сотрудников организации, тыс.руб. 2022",
  "Средняя з.п. всех сотрудников организации, тыс.руб. 2023",
  "Средняя з.п. всех сотрудников организации, тыс.руб. 2024",
  "Средняя з.п. сотрудников, работающих в Москве, тыс.руб. 2022",
  "Средняя з.п. сотрудников, работающих в Москве, тыс.руб. 2023",
  "Средняя з.п. сотрудников, работающих в Москве, тыс.руб. 2024",
  "Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2022",
  "Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2023",
  "Налоги, уплаченные в бюджет Москвы (без акцизов), тыс.руб. 2024",
  "Налог на прибыль, тыс.руб. 2022",
  "Налог на прибыль, тыс.руб. 2023",
  "Налог на прибыль, тыс.руб. 2024",
  "Налог на имущество, тыс.руб. 2022",
  "Налог на имущество, тыс.руб. 2023",
  "Налог на имущество, тыс.руб. 2024",
  "Налог на землю, тыс.руб. 2022",
  "Налог на землю, тыс.руб. 2023",
  "Налог на землю, тыс.руб. 2024",
  "НДФЛ, тыс.руб. 2022",
  "НДФЛ, тыс.руб. 2023",
  "НДФЛ, тыс.руб. 2024",
  "Транспортный налог, тыс.руб. 2022",
  "Транспортный налог, тыс.руб. 2023",
  "Транспортный налог, тыс.руб. 2024",
  "Прочие налоги 2022",
  "Прочие налоги 2023",
  "Прочие налоги 2024",
  "Акцизы, тыс. руб. 2022",
  "Акцизы, тыс. руб. 2023",
  "Акцизы, тыс. руб. 2024",
  "Инвестиции в Мск 2022 тыс. руб.",
  "Инвестиции в Мск 2023 тыс. руб.",
  "Инвестиции в Мск 2024 тыс. руб.",
  "Объем экспорта, тыс. руб. 2022",
  "Объем экспорта, тыс. руб. 2023",
  "Объем экспорта, тыс. руб. 2024",
  "Кадастровый номер ЗУ",
  "Площадь ЗУ",
  "Вид разрешенного использования ЗУ",
  "Вид собственности ЗУ",
  "Собственник ЗУ",
  "Кадастровый номер ОКСа",
  "Площадь ОКСов",
  "Вид разрешенного использования ОКСов",
  "Тип строения и цель использования",
  "Вид собственности ОКСов",
  "Собственник ОКСов",
  "Площадь производственных помещений, кв.м.",
  "Стандартизированная продукция",
  "Название (виды производимой продукции)",
  "Перечень производимой продукции по кодам ОКПД 2",
  "Перечень производимой продукции по типам и сегментам",
  "Каталог продукции",
  "Наличие госзаказа",
  "Уровень загрузки производственных мощностей",
  "Наличие поставок продукции на экспорт",
  "Объем экспорта (млн руб.) за предыдущий календарный год",
  "Перечень государств-импортеров",
  "Координаты юридического адреса",
  "Координаты адреса производства",
  "Координаты адреса дополнительной площадки",
  "Координаты (широта)",
  "Координаты (долгота)",
  "Округ",
  "Район",
];


const AddCompanyForm = (props: AddCompanyForm) => {
  const [addedFields, setAddedFields] = useState<string[]>([]);

  const handleSelect = (value: string) => {
    if (value && !addedFields.includes(value)) {
      setAddedFields([...addedFields, value]);
    }
  };

  const handleRemove = (field: string) => {
    setAddedFields(addedFields.filter((f) => f !== field));
  };

  return (
    <div className="w-full max-w-3xl">
      <form className="flex flex-col gap-5">

        <div>
          <Label htmlFor="inn" value="ИНН *" />
          <TextInput id="inn" placeholder="Введите ИНН" required />
        </div>

        <div>
          <Label htmlFor="orgName" value="Наименование организации *" />
          <TextInput
            id="orgName"
            placeholder="Введите краткое название"
            required
          />
        </div>

        <div>
          <Label
            htmlFor="orgFullName"
            value="Полное наименование организации *"
          />
          <TextInput
            id="orgFullName"
            placeholder="Введите полное название"
            required
          />
        </div>

        <div>
          <Label htmlFor="status" value="Статус *" />
          <TextInput id="status" placeholder="Например: Действующая" required />
        </div>

        <div>
          <Label htmlFor="address" value="Юридический адрес *" />
          <TextInput id="address" placeholder="Введите адрес" required />
        </div>

        {addedFields.length > 0 && (
          <div className="flex flex-col gap-4 mt-2">
            {addedFields.map((field) => (
              <div key={field} className="flex items-center gap-2 transition">
                <div className="flex-1">
                  <Label htmlFor={field}>{field}</Label>
                  <TextInput
                    id={field}
                    placeholder={`Введите ${field.toLowerCase()}`}
                  />
                </div>
                <button
                  type="button"
                  onClick={() => handleRemove(field)}
                  className="text-red-500 hover:text-red-700 transition"
                >
                  <AiOutlineCloseCircle size={22} />
                </button>
              </div>
            ))}
          </div>
        )}

        <div>
          <Label value="Добавить дополнительное поле" />
          <Select
            id="extraField"
            onChange={(e) => handleSelect(e.target.value)}
            className="mt-2"
          >
            <option value="">Выберите поле...</option>
            {allExtraFields.map((field) => (
              <option key={field} value={field}>
                {field}
              </option>
            ))}
          </Select>
        </div>
        <Label className="mt-5 text-gray-500" value="Поля, отмеченные звездочкой * - обязательны для заполнения" />
        {/* Кнопки */}
        <div className="flex justify-center gap-4 mt-6">
          <Button onClick={() => props.onCloseModalAction(false)} color="gray">Отмена</Button>
          <Button color="success">Добавить</Button>
        </div>
      </form>
    </div>
  );
};

export default AddCompanyForm;
